<div class="accordion collapse show" id="accordionSideBar">
  <div class="card"><a class="card-header" data-toggle="collapse" data-target="#SideBar0" aria-expanded="true"
      aria-controls="SideBar0"><span>永磁除铁器</span><i class="fas fa-chevron-down pt-1 float-right"
        style="font-size: 16px;"></i></a>
    <div class="list-group collapse <a href=" product="" categorys="" 1="" samples="" 1.html"="">易清理料仓式稀土永磁格栅 show "
      id="SideBar0" data-parent="#accordionSideBar"&gt;<a href="/Product/Categorys/1/Samples/2.html"
        class="list-group-item list-group-item-action  active  ">磁棒</a> </div>
  </div>
  <div class="card"><a class="card-header" data-toggle="collapse" data-target="#SideBar1" aria-expanded="true"
      aria-controls="SideBar1"><span>电磁除铁器</span><i class="fas fa-chevron-down pt-1 float-right"
        style="font-size: 16px;"></i></a></div>
</div>













<!-- BEGIN 搜索框 与 折叠按键 -->
<form class="bd-search d-flex align-items-center">
    <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..."
        autocomplete="off" data-docs-version="4.3">
    <button class="btn btn-link d-md-none p-0 ml-3" type="button" data-toggle="collapse" data-target="#accordionSideBar"
        aria-controls="accordionSideBar">
        <i class="fas fa-list-ul" style="font-size: 30px;"></i>
    </button>
    <br>
</form>
<!-- END 搜索框 与 折叠按键 -->
<div class="accordion collapse show" id="accordionSideBar">
    <!-- 内部js填充内容 -->
</div>
<script>
    //获取上下文数据，定义在context_processors.py
    //采用 |safe ，可以防止数据被渲染成html；
    var myJson = {{ product_sidebar | safe}};
    //获取本页面产品实例的id。必须在调用该脚本之前被加载，否则会出错。
    var m_sampleID = document.getElementById("sampleID").innerHTML;
    //循环列表
    var html = "" //创建一个容器，把循环出来的数据装到此对象数组中
    $.each(myJson, function (i, item) {//循环返回的数据
        html += '<div class="card"><a class="card-header" data-toggle="collapse" data-target="#SideBar' + i + '" aria-expanded="true" aria-controls="SideBar' + i + '">';
        html += '<span>' + item.title + '</span>'
        html += '<i class="fas fa-chevron-down pt-1 float-right" style="font-size: 16px;"></i>'
        html += '</a>'
        //如果第一级菜单有children参数，就继续循环第二级
        if (item.children != undefined && item.children.length > 0) {
            html += '<div class="list-group collapse ';
            var flag1=true;//用于标记顶栏展开过程，true：可以增加渲染；false：已经渲染过了；
            $.each(item.children, function (j, item2) {
                if(flag1){
                    flag1=false;
                    if(m_sampleID == item2.id){
                        html+='show ' + '" id="SideBar' + i + '" data-parent="#accordionSideBar">';
                        
                        // BEGIN 面包屑导航
                        //在这里我们把面包屑导航也渲染了
                        var breadcrumb_str="";
                        breadcrumb_str += '<ol class="breadcrumb">';

                        breadcrumb_str += '<li class="breadcrumb-item"><a href="'
                        breadcrumb_str += ' https:\\www.tjbeisu.com '
                        breadcrumb_str += '">首页</a></li>';

                        breadcrumb_str += '<li class="breadcrumb-item"><a href="'
                        breadcrumb_str += ' https:\\www.tjbeisu.com/Product '
                        breadcrumb_str += '">产品中心</a></li>';

                        breadcrumb_str += '<li class="breadcrumb-item"><a href="'
                        breadcrumb_str += item.url
                        breadcrumb_str +='">'
                        breadcrumb_str += item.title
                        breadcrumb_str += '</a></li>';

                        breadcrumb_str += '<li class="breadcrumb-item active" aria-current="page">'
                        breadcrumb_str += item2.title
                        breadcrumb_str += '</li>';
                        
                        breadcrumb_str += '</ol>';
                        $('#m_breadcrumb').html(breadcrumb_str);
                        // END 面包屑导航
                    }
                };
                // 如果产品实例id 等于该 item2.id ， 则激活该栏
                if(m_sampleID == item2.id){
                    html += '<a href="'  + item2.url +  '" class="list-group-item list-group-item-action '+' active ' +' ">';
                }
                else{
                    html += '<a href="'  + item2.url +  '" class="list-group-item list-group-item-action ">';     
                };
                    
                html += item2.title;
                html += '</a> ';
            });
            if(flag1)
            {
                html+='" id="SideBar' + i + '" data-parent="#accordionSideBar">';
            }
            html += '</div>'
        }
        html += '</div>';
    });
    //将对象数组的内容在页面id为side-menu的容器里面渲染出来。
    $('#accordionSideBar').html(html);
</script>
<script>
    // 作用于菜单，增加向右、向下的箭头
    $(document).ready(function () {
        // 增加向有的箭头
        $(".collapse.show").each(function () {
            $(this).prev(".card-header").find(".fas").addClass("fa-chevron-down").removeClass("fa-chevron-right");
        });

        // 当有触发时，向下的箭头 ----  向右的箭头   来回切换
        $(".collapse").on('show.bs.collapse', function () {
            $(this).prev(".card-header").find(".fas").removeClass("fa-chevron-right").addClass("fa-chevron-down");
        }).on('hide.bs.collapse', function () {
            $(this).prev(".card-header").find(".fas").removeClass("fa-chevron-down").addClass("fa-chevron-right");
        });
    });
</script>
<script>
// 填充面包屑导航
</script>